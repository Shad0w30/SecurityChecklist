<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Security Checklist Flashcards</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    :root {
      /* Theme variables */
      --primary-color: #4a6baf;
      --secondary-color: #6c757d;
      --accent-color: #3a86ff;
      --bg-color: #f5f7fa;
      --card-bg: #ffffff;
      --text-color: #333;
      --border-color: #dee2e6;
      --shadow-color: rgba(0, 0, 0, 0.1);
      --pre-bg: #f8f9fa;
      --pre-border: #dee2e6;
      --tech-logo-opacity: 0.03;
      --tech-logo-size: 40%;
    }

    /* Technology-specific themes */
    [data-tech="web"] {
      --primary-color: #4a6baf;
      --accent-color: #3a86ff;
      --tech-logo: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTEyIDBDNS4zNzMgMCAwIDUuMzczIDAgMTJzNS4zNzMgMTIgMTIgMTIgMTItNS4zNzMgMTItMTJTMTguNjI3IDAgMTIgMHptMCAyMi4wODJjLTUuNTc0IDAtMTAuMDgyLTQuNTA4LTEwLjA4Mi0xMC4wODJTNi40MjYgMS45MTggMTIgMS45MThzMTAuMDgyIDQuNTA4IDEwLjA4MiAxMC4wODJjMCA1LjU3NC00LjUwOCAxMC4wODItMTAuMDgyIDEwLjA4MnpNMTIgNC45MzZjLTMuODc0IDAtNy4wNDYgMy4xNzItNy4wNDYgNy4wNDZTOC4xMjYgMTkuMDY0IDEyIDE5LjA2NHM3LjA0Ni0zLjE3MiA3LjA0Ni03LjA0NlMxNS44NzQgNC45MzYgMTIgNC45MzZ6bTAgMTEuMTU1Yy0yLjI2NCAwLTQuMTAxLTEuODM3LTQuMTAxLTQuMTAxczEuODM3LTQuMTAxIDQuMTAxLTQuMTAxIDQuMTAxIDEuODM3IDQuMTAxIDQuMTAxLTEuODM3IDQuMTAxLTQuMTAxIDQuMTAxeiIvPjwvc3ZnPg==');
    }
    
    [data-tech="mobile"] {
      --primary-color: #8e44ad;
      --accent-color: #9b59b6;
      --tech-logo: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTE1LjUgMWgtN0E0LjUwNCA0LjUwNCAwIDAgMCA0IDUuNXYxM0E0LjUwNCA0LjUwNCAwIDAgMCA3LjUgMjNoOUE0LjUwNCA0LjUwNCAwIDAgMCAyMSAxOC41di0xM0E0LjUwNCA0LjUwNCAwIDAgMCAxNy41IDF6bS01IDE2LjVhMS41IDEuNSAwIDEgMSAxLjUtMS41IDEuNSAxLjUgMCAwIDEtMS41IDEuNXpNMTggMTVINlY0aDEydjExeiIvPjwvc3ZnPg==');
    }
    
    [data-tech="cloud"] {
      --primary-color: #e74c3c;
      --accent-color: #c0392b;
      --tech-logo: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTE5LjM1IDkuMDRDMjEuOTUgOS41OCAyNCAxMS45NyAyNCAxNWMwIDMuMzEtMi42OSA2LTYgNkg2Yy0zLjMxIDAtNi0yLjY5LTYtNiAwLTMuMDMgMi4xNi01LjU2IDUtNi4wMkM1LjU2IDYuNjEgNS4zIDYuMDggNSA1LjUgNSAzLjAxIDcuMDEgMSA5LjUgMVMxNCAzLjAxIDE0IDUuNWMwIC41OC0uMTYgMS4xMS0uNDMgMS41NCAxLjA3LjE4IDIuMDMuNyAyLjgxIDEuNDZ6Ii8+PC9zdmc+');
    }
    
    [data-tech="cert"] {
      --primary-color: #27ae60;
      --accent-color: #2ecc71;
      --tech-logo: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTIzIDEybC0yLjQ0NC0yLjQzNCAxLjQxMi0xLjQxMiAyLjQzNCAyLjQ0NEwyMyAxMnptLTYuMTY2LTIuMzg0bC0xLjQxMiAxLjQxMiA0Ljg3OCA0Ljg3OCAxLjQxMi0xLjQxMi00Ljg3OC00Ljg3OHpNMTIgMTguNTQxbC03Ljc1MiA0LjU4NCAxLjY5LTkuMTI4TDEyIDE4LjU0MXptMC0xMi4wMkwzLjM0NyAxOC4zNjVsMS4zOTEtNy41MDRMMTIgNi41MjF6Ii8+PC9zdmc+');
    }

    /* Dark theme */
    [data-theme="dark"] {
      --bg-color: #121212;
      --text-color: #e0e0e0;
      --card-bg: #1e1e1e;
      --border-color: #333;
      --shadow-color: rgba(0, 0, 0, 0.3);
      --pre-bg: #252525;
      --pre-border: #444;
      --tech-logo-opacity: 0.05;
    }

    /* Bright theme */
    [data-theme="bright"] {
      --bg-color: #ffffff;
      --text-color: #333;
      --card-bg: #f8f9fa;
      --border-color: #dee2e6;
      --shadow-color: rgba(0, 0, 0, 0.1);
      --pre-bg: #ffffff;
      --pre-border: #dee2e6;
      --tech-logo-opacity: 0.03;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      min-height: 100vh;
      position: relative;
      transition: all 0.3s ease;
    }

    body::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: var(--tech-logo);
      background-size: var(--tech-logo-size);
      background-repeat: no-repeat;
      background-position: center center;
      opacity: var(--tech-logo-opacity);
      pointer-events: none;
      z-index: -1;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    header {
      text-align: center;
      margin-bottom: 2rem;
      position: relative;
    }

    h1 {
      color: var(--primary-color);
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1rem;
    }

    h1::before,
    h1::after {
      content: "‚Ä¢";
      color: var(--accent-color);
    }

    .subtitle {
      color: var(--secondary-color);
      font-size: 1.1rem;
      max-width: 600px;
      margin: 0 auto 1.5rem;
    }

    .controls {
      background-color: var(--card-bg);
      padding: 1.5rem;
      border-radius: 8px;
      box-shadow: 0 4px 6px var(--shadow-color);
      margin-bottom: 2rem;
    }

    .tech-selectors {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .tech-selector {
      flex: 1;
      min-width: 200px;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--primary-color);
    }

    select, input {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      background-color: var(--card-bg);
      color: var(--text-color);
      font-size: 1rem;
      transition: border-color 0.3s;
    }

    select:focus, input:focus {
      outline: none;
      border-color: var(--accent-color);
    }

    .btn-group {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    button {
      padding: 0.75rem 1.5rem;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
      transition: all 0.3s;
      flex: 1;
      min-width: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    button:hover {
      background-color: var(--accent-color);
      transform: translateY(-2px);
    }

    button:active {
      transform: translateY(0);
    }

    /* Flashcard system */
    .flashcard-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
    }

    .flashcard {
      background-color: var(--card-bg);
      border-radius: 8px;
      box-shadow: 0 4px 6px var(--shadow-color);
      padding: 1.5rem;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
      border-left: 4px solid var(--primary-color);
    }

    .flashcard:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 12px var(--shadow-color);
    }

    .flashcard h3 {
      color: var(--primary-color);
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .flashcard .reference {
      color: var(--secondary-color);
      font-size: 0.9rem;
      margin-bottom: 1rem;
      display: block;
    }

    .controls-list {
      padding-left: 1.25rem;
      max-height: 300px;
      overflow-y: auto;
      margin-top: 0.5rem;
    }

    .controls-list li {
      margin-bottom: 0.75rem;
      position: relative;
      padding-left: 1.5rem;
    }

    .controls-list li::before {
      content: "‚Ä¢";
      color: var(--accent-color);
      position: absolute;
      left: 0;
      font-size: 1.5rem;
      line-height: 1;
    }

    .category-count {
      background-color: var(--accent-color);
      color: white;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      margin-left: 0.5rem;
    }

    .search-box {
      margin-bottom: 1rem;
      position: relative;
    }

    .search-box input {
      padding-left: 2.5rem;
    }

    .search-icon {
      position: absolute;
      left: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--secondary-color);
    }

    .empty-state {
      text-align: center;
      padding: 3rem;
      color: var(--secondary-color);
      grid-column: 1 / -1;
    }

    .empty-state h3 {
      color: var(--primary-color);
      margin-bottom: 1rem;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .container {
        padding: 1rem;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .tech-selectors {
        flex-direction: column;
      }
      
      .btn-group {
        flex-direction: column;
      }
      
      button {
        width: 100%;
      }
      
      .flashcard-container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üîí Security Checklist Flashcards</h1>
      <p class="subtitle">Interactive security best practices for developers, cloud engineers, and security professionals</p>
    </header>
    
    <div class="controls">
      <div class="tech-selectors">
        <div class="tech-selector">
          <label for="platform">Technology/Platform:</label>
          <select id="platform">
            <option value="">-- Select Technology --</option>
            <option value="web">Web Application Security</option>
            <option value="mobile">Mobile Security</option>
            <option value="cloud">Cloud Security</option>
            <option value="cert">Security Certifications</option>
          </select>
        </div>
        
        <div class="tech-selector">
          <label for="category">Category:</label>
          <select id="category" disabled>
            <option value="">-- Select a Technology First --</option>
          </select>
        </div>
      </div>
      
      <div class="search-box">
        <span class="search-icon">üîç</span>
        <input type="text" id="search" placeholder="Search controls...">
      </div>
      
      <div class="btn-group">
        <button id="generate">üîç Generate Flashcards</button>
        <button id="download">‚¨áÔ∏è Download Checklist</button>
        <button id="theme-toggle">üåô Toggle Theme</button>
      </div>
    </div>
    
    <div class="flashcard-container" id="flashcards">
      <div class="empty-state">
        <h3>Select a technology and category to begin</h3>
        <p>Security best practices will appear as interactive flashcards</p>
      </div>
    </div>
  </div>

  <script>
    // Theme configuration
    const platformThemes = {
      "web": "dark",
      "mobile": "dark",
      "cloud": "bright",
      "cert": "bright"
    };

    // Technology-specific data
    const checklistData = {
      web: [
        {
          name: "Authentication",
          reference: "https://owasp.org/www-project-top-ten/",
          controls: [
            "Implement multi-factor authentication for all user accounts",
            "Enforce strong password policies (min 12 chars, complexity)",
            "Implement secure password recovery mechanisms",
            "Use secure session management with expiration",
            "Implement account lockout after multiple failed attempts",
            "Use OAuth 2.0 or OpenID Connect for third-party auth",
            "Protect against credential stuffing attacks",
            "Implement biometric authentication securely",
            "Use passwordless authentication where appropriate",
            "Secure session tokens with HttpOnly and Secure flags",
            "Implement re-authentication for sensitive operations",
            "Use modern hashing algorithms (bcrypt, Argon2)",
            "Protect against session fixation attacks",
            "Implement proper logout functionality",
            "Monitor for suspicious authentication activities",
            "Implement CAPTCHA for high-risk authentication flows",
            "Use secure cookie attributes (SameSite, HttpOnly)",
            "Protect against brute force attacks",
            "Implement security questions securely",
            "Use hardware security keys for high-privilege accounts"
          ]
        },
        {
          name: "Authorization",
          reference: "https://owasp.org/www-project-top-ten/",
          controls: [
            "Implement least privilege principle for all roles",
            "Use role-based access control (RBAC)",
            "Implement attribute-based access control (ABAC) where needed",
            "Enforce access control checks on every request",
            "Protect against IDOR (Insecure Direct Object Reference)",
            "Implement proper admin interface security",
            "Segregate duties for sensitive operations",
            "Implement time-based access restrictions",
            "Enforce location-based access controls where appropriate",
            "Implement proper access control for APIs",
            "Regularly review and audit access controls",
            "Implement just-in-time access provisioning",
            "Use centralized authorization management",
            "Protect against privilege escalation",
            "Implement mandatory access control for sensitive data",
            "Use policy-based authorization frameworks",
            "Implement proper error handling for access denied",
            "Enforce separation of environments (dev, staging, prod)",
            "Implement access control for file uploads/downloads",
            "Use security tokens for distributed authorization"
          ]
        },
        {
          name: "Input Validation",
          reference: "https://owasp.org/www-project-top-ten/",
          controls: [
            "Validate all user inputs on server side",
            "Implement allow-list validation approach",
            "Sanitize all inputs before processing",
            "Validate content type for file uploads",
            "Implement maximum length constraints",
            "Use parameterized queries for database access",
            "Validate and sanitize HTML output",
            "Protect against SQL injection attacks",
            "Prevent cross-site scripting (XSS) vulnerabilities",
            "Protect against command injection attacks",
            "Validate and sanitize XML inputs",
            "Protect against XML external entity (XXE) attacks",
            "Validate JSON inputs and schemas",
            "Protect against insecure deserialization",
            "Implement proper error handling without leakage",
            "Use regular expressions carefully",
            "Validate and sanitize all headers",
            "Protect against HTTP parameter pollution",
            "Implement CSRF protection mechanisms",
            "Use modern frameworks with built-in protections"
          ]
        }
      ],
      mobile: [
        {
          name: "Data Storage",
          reference: "https://owasp.org/www-project-mobile-top-10/",
          controls: [
            "Use secure storage for sensitive data",
            "Encrypt sensitive data at rest",
            "Avoid storing sensitive data in plain text",
            "Use Keychain (iOS) and Keystore (Android)",
            "Implement secure file storage practices",
            "Protect against insecure data storage",
            "Use encrypted databases when needed",
            "Secure app-specific storage areas",
            "Implement proper cache management",
            "Clear sensitive data from memory after use"
          ]
        },
        {
          name: "Authentication",
          reference: "https://owasp.org/www-project-mobile-top-10/",
          controls: [
            "Implement biometric authentication securely",
            "Use secure token storage",
            "Implement session timeout",
            "Protect against credential caching",
            "Secure authentication tokens",
            "Implement multi-factor authentication",
            "Protect against insecure authentication"
          ]
        }
      ],
      cloud: [
        {
          name: "AWS Security",
          reference: "https://aws.amazon.com/security/",
          controls: [
            "Implement IAM roles and policies with least privilege",
            "Enable CloudTrail logging for all regions",
            "Use AWS Config for resource tracking",
            "Enable GuardDuty for threat detection",
            "Implement VPC security groups properly",
            "Encrypt S3 buckets and enable versioning",
            "Use AWS KMS for encryption key management",
            "Enable multi-factor authentication for root account",
            "Implement security groups and NACLs properly",
            "Regularly rotate access keys and credentials"
          ]
        },
        {
          name: "Azure Security",
          reference: "https://azure.microsoft.com/en-us/services/security-center/",
          controls: [
            "Implement Azure AD with conditional access",
            "Use Azure Security Center for monitoring",
            "Enable Azure Defender for advanced protection",
            "Implement network security groups properly",
            "Use Azure Key Vault for secrets management",
            "Enable Azure Monitor and Log Analytics",
            "Implement Azure Policy for compliance",
            "Use managed identities for resources",
            "Enable JIT VM access with Azure Security Center",
            "Encrypt storage accounts and virtual disks"
          ]
        },
        {
          name: "GCP Security",
          reference: "https://cloud.google.com/security",
          controls: [
            "Implement Cloud Identity and Access Management",
            "Use VPC Service Controls for data isolation",
            "Enable Security Command Center",
            "Use Cloud KMS for encryption key management",
            "Implement Cloud Audit Logging for all services",
            "Use Identity-Aware Proxy for secure access",
            "Implement firewall rules with least privilege",
            "Enable Data Loss Prevention API",
            "Use Cloud Security Scanner for vulnerabilities",
            "Implement organization policies for compliance"
          ]
        }
      ],
      cert: [
        {
          name: "CISSP",
          reference: "https://www.isc2.org/Certifications/CISSP",
          controls: [
            "Security and Risk Management concepts",
            "Asset Security classification and protection",
            "Security Architecture and Engineering principles",
            "Communication and Network Security",
            "Identity and Access Management controls",
            "Security Assessment and Testing methodologies",
            "Security Operations best practices",
            "Software Development Security principles",
            "Legal, regulations, and compliance requirements",
            "Incident response and disaster recovery planning"
          ]
        },
        {
          name: "CISM",
          reference: "https://www.isaca.org/credentialing/cism",
          controls: [
            "Information Security Governance framework",
            "Information Risk Management practices",
            "Information Security Program development",
            "Incident Management and response",
            "Security metrics and reporting",
            "Compliance management strategies",
            "Security policy development",
            "Business continuity planning",
            "Vendor and third-party risk management",
            "Security awareness and training programs"
          ]
        },
        {
          name: "CCSP",
          reference: "https://www.isc2.org/Certifications/CCSP",
          controls: [
            "Cloud Concepts, Architecture and Design",
            "Cloud Data Security principles",
            "Cloud Platform and Infrastructure Security",
            "Cloud Application Security best practices",
            "Cloud Security Operations",
            "Legal, Risk and Compliance in cloud",
            "Secure cloud migration strategies",
            "Cloud identity and access management",
            "Cloud encryption and key management",
            "Incident response in cloud environments"
          ]
        }
      ]
    };

    // DOM elements
    const platformSelect = document.getElementById('platform');
    const categorySelect = document.getElementById('category');
    const searchInput = document.getElementById('search');
    const generateBtn = document.getElementById('generate');
    const downloadBtn = document.getElementById('download');
    const themeToggleBtn = document.getElementById('theme-toggle');
    const flashcardsContainer = document.getElementById('flashcards');
    
    // Current state
    let currentTheme = 'dark';
    let currentTech = '';
    let currentCategory = '';
    let filteredControls = [];
    
    // Initialize
    function init() {
      // Set initial theme
      document.body.setAttribute('data-theme', currentTheme);
      
      // Set up event listeners
      platformSelect.addEventListener('change', handlePlatformChange);
      categorySelect.addEventListener('change', handleCategoryChange);
      generateBtn.addEventListener('click', generateFlashcards);
      downloadBtn.addEventListener('click', downloadChecklist);
      themeToggleBtn.addEventListener('click', toggleTheme);
      searchInput.addEventListener('input', filterControls);
      
      // Set up platform themes
      document.body.setAttribute('data-tech', 'web');
    }
    
    // Handle platform selection
    function handlePlatformChange() {
      const tech = platformSelect.value;
      currentTech = tech;
      
      if (!tech) {
        categorySelect.disabled = true;
        categorySelect.innerHTML = '<option value="">-- Select a Technology First --</option>';
        return;
      }
      
      // Set technology-specific styling
      document.body.setAttribute('data-tech', tech);
      document.body.setAttribute('data-theme', platformThemes[tech] || 'dark');
      currentTheme = platformThemes[tech] || 'dark';
      
      // Populate categories
      const categories = checklistData[tech] || [];
      categorySelect.disabled = false;
      categorySelect.innerHTML = '<option value="">-- All Categories --</option>';
      
      categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category.name;
        option.textContent = `${category.name} (${category.controls.length})`;
        categorySelect.appendChild(option);
      });
      
      // Enable generate button
      generateBtn.disabled = false;
    }
    
    // Handle category selection
    function handleCategoryChange() {
      currentCategory = categorySelect.value;
      generateBtn.disabled = !currentTech;
    }
    
    // Generate flashcards
    function generateFlashcards() {
      if (!currentTech) return;
      
      const categories = checklistData[currentTech] || [];
      let filteredCategories = [];
      
      // Filter by selected category if any
      if (currentCategory) {
        filteredCategories = categories.filter(cat => cat.name === currentCategory);
      } else {
        filteredCategories = [...categories];
      }
      
      // Apply search filter if any
      const searchTerm = searchInput.value.toLowerCase().trim();
      if (searchTerm) {
        filteredCategories = filteredCategories.map(category => {
          const filteredControls = category.controls.filter(control => 
            control.toLowerCase().includes(searchTerm)
          );
          return {...category, controls: filteredControls};
        }).filter(category => category.controls.length > 0);
      }
      
      // Render flashcards
      renderFlashcards(filteredCategories);
    }
    
    // Render flashcards to the container
    function renderFlashcards(categories) {
      if (!categories.length) {
        flashcardsContainer.innerHTML = `
          <div class="empty-state">
            <h3>No controls found</h3>
            <p>Try adjusting your filters or search term</p>
          </div>
        `;
        return;
      }
      
      flashcardsContainer.innerHTML = '';
      
      categories.forEach(category => {
        const flashcard = document.createElement('div');
        flashcard.className = 'flashcard';
        flashcard.innerHTML = `
          <h3>${category.name} <span class="category-count">${category.controls.length}</span></h3>
          <a href="${category.reference}" target="_blank" class="reference">${category.reference}</a>
          <ol class="controls-list">
            ${category.controls.map((control, i) => 
              `<li>${control}</li>`).join('')}
          </ol>
        `;
        flashcardsContainer.appendChild(flashcard);
      });
    }
    
    // Filter controls based on search input
    function filterControls() {
      generateFlashcards();
    }
    
    // Download checklist
    function downloadChecklist() {
      if (!currentTech) return;
      
      const categories = checklistData[currentTech] || [];
      if (!categories.length) return;
      
      const ws_data = [["#", "Category", "Control"]];
      let counter = 1;
      
      categories.forEach(category => {
        category.controls.forEach(control => {
          ws_data.push([counter++, category.name, control]);
        });
      });
      
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.aoa_to_sheet(ws_data);
      
      // Set column widths
      ws['!cols'] = [
        {wch: 5},   // # column
        {wch: 20},  // Category column
        {wch: 100}  // Control column
      ];
      
      XLSX.utils.book_append_sheet(wb, ws, "Security Checklist");
      XLSX.writeFile(wb, `SecurityChecklist_${currentTech}.xlsx`);
    }
    
    // Toggle theme
    function toggleTheme() {
      currentTheme = currentTheme === 'dark' ? 'bright' : 'dark';
      document.body.setAttribute('data-theme', currentTheme);
      themeToggleBtn.textContent = currentTheme === 'dark' ? '‚òÄÔ∏è Light Theme' : 'üåô Dark Theme';
    }
    
    // Initialize the application
    init();
  </script>
</body>
</html>
